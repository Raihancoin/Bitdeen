<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BitDeen Tasks</title>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background: #f9fafb;
      color: #111;
    }
    .top-bar {
      background: #111;
      color: #facc15;
      padding: 16px;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
    }
    .container {
      padding: 20px;
    }
    .task-card {
      background: #fff;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
    }
    .task-card h3 {
      margin: 0 0 8px;
      color: #111;
    }
    .task-card p {
      margin: 0 0 12px;
      font-size: 14px;
      color: #555;
    }
    .task-card button {
      background-color: #facc15;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
    .task-card button:disabled {
      background-color: #e5e7eb;
      color: #aaa;
      cursor: not-allowed;
    }
    .bottom-nav {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
    }
    .bottom-nav a {
      color: #facc15;
      text-decoration: none;
      font-size: 14px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="top-bar">üìã Daily Tasks</div>
  <div class="container" id="taskList">
    <div class="task-card" id="dailyCheck">
      <h3>üóìÔ∏è Daily Check-In</h3>
      <p>Earn 10 BDN every 24 hours by checking in.</p>
      <button id="checkBtn">Claim 10 BDN</button>
    </div>
    <p>Loading tasks...</p>
  </div>  <div class="bottom-nav">
    <a href="index.html">üè†<br>Home</a>
    <a href="tasks.html">üìã<br>Tasks</a>
    <a href="referral.html">üîó<br>Referral</a>
    <a href="boost.html">‚ö°<br>Boost</a>
  </div>  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import { getDatabase, ref, onValue, get, child, update } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBxQ4EiH_aTCyJm5_VT0cRSDD97F_ObG1o",
      authDomain: "bitdeen-a1ebe.firebaseapp.com",
      databaseURL: "https://bitdeen-a1ebe-default-rtdb.firebaseio.com",
      projectId: "bitdeen-a1ebe",
      storageBucket: "bitdeen-a1ebe.appspot.com",
      messagingSenderId: "957332775205",
      appId: "1:957332775205:web:e34cc38d4d5282adc43acc",
      measurementId: "G-FY8TBYBJ58"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    let uid = localStorage.getItem("bitdeen_uid");
    if (!uid) {
      uid = "user_" + Math.floor(Math.random() * 1000000000);
      localStorage.setItem("bitdeen_uid", uid);
    }

    const checkBtn = document.getElementById("checkBtn");

    // Daily check-in with 24hr timer
    async function setupDailyCheck() {
      const now = Date.now();
      const userRef = ref(db, `users/${uid}`);
      const userSnap = await get(child(ref(db), `users/${uid}`));
      const lastClaim = userSnap.exists() && userSnap.val().dailyCheckTime ? userSnap.val().dailyCheckTime : 0;
      const nextAllowed = lastClaim + 86400000; // 24 hours

      if (now < nextAllowed) {
        checkBtn.disabled = true;
        const interval = setInterval(() => {
          const timeLeft = nextAllowed - Date.now();
          if (timeLeft <= 0) {
            clearInterval(interval);
            checkBtn.disabled = false;
            checkBtn.textContent = "Claim 10 BDN";
          } else {
            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            checkBtn.textContent = `Next claim: ${hours}h ${minutes}m ${seconds}s`;
          }
        }, 1000);
      }
    }

    checkBtn.addEventListener("click", async () => {
      const now = Date.now();
      const userRef = ref(db, `users/${uid}`);
      const userSnap = await get(child(ref(db), `users/${uid}`));
      let current = (userSnap.exists() && userSnap.val().bdn) || 0;

      await update(userRef, {
        bdn: current + 10,
        dailyCheckTime: now
      });

      checkBtn.disabled = true;
      checkBtn.textContent = "Next claim: 24h 0m 0s";
      setupDailyCheck();
      alert("‚úÖ Daily check-in successful! 10 BDN added to your balance.");
    });

    setupDailyCheck();

    // Load Admin Tasks
    const taskList = document.getElementById("taskList");
    function renderTask(taskId, title, desc, link, reward) {
      const div = document.createElement("div");
      div.className = "task-card";
      div.innerHTML = `
        <h3>${title}</h3>
        <p>${desc}</p>
        <button onclick="window.open('${link}', '_blank')">Do Task</button>
        <button onclick="claimReward('${taskId}', ${reward})">Claim ${reward}üíé</button>
      `;
      taskList.appendChild(div);
    }

    onValue(ref(db, "tasks/"), (snapshot) => {
      const existing = document.querySelectorAll(".task-card");
      existing.forEach((e, i) => { if (i !== 0) e.remove(); });
      if (snapshot.exists()) {
        const data = snapshot.val();
        for (const id in data) {
          const task = data[id];
          renderTask(id, task.title, task.desc, task.link, task.reward);
        }
      }
    });

    window.claimReward = async function(taskId, reward) {
      const userTaskRef = ref(db, `users/${uid}/completed/${taskId}`);
      const completedSnap = await get(userTaskRef);
      if (completedSnap.exists()) {
        alert("‚ùå You already claimed this task.");
        return;
      }
      const userRef = ref(db, `users/${uid}`);
      const snapshot = await get(child(ref(db), `users/${uid}`));
      let current = (snapshot.exists() && snapshot.val().diamonds) || 0;
      await update(userRef, {
        diamonds: current + reward,
        [`completed/${taskId}`]: true
      });
      alert(`‚úÖ Task verified and ${reward} Diamonds added!`);
    };
  </script></body>
</html<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BitDeen Tasks</title>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background: #f9fafb;
      color: #111;
    }
    .top-bar {
      background: #111;
      color: #facc15;
      padding: 16px;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
    }
    .container {
      padding: 20px;
    }
    .task-card {
      background: #fff;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
    }
    .task-card h3 {
      margin: 0 0 8px;
      color: #111;
    }
    .task-card p {
      margin: 0 0 12px;
      font-size: 14px;
      color: #555;
    }
    .task-card button {
      background-color: #facc15;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
    .task-card button:disabled {
      background-color: #e5e7eb;
      color: #aaa;
      cursor: not-allowed;
    }
    .bottom-nav {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
    }
    .bottom-nav a {
      color: #facc15;
      text-decoration: none;
      font-size: 14px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="top-bar">üìã Daily Tasks</div>
  <div class="container" id="taskList">
    <div class="task-card" id="dailyCheck">
      <h3>üóìÔ∏è Daily Check-In</h3>
      <p>Earn 10 BDN every 24 hours by checking in.</p>
      <button id="checkBtn">Claim 10 BDN</button>
    </div>
    <p>Loading tasks...</p>
  </div>  <div class="bottom-nav">
    <a href="index.html">üè†<br>Home</a>
    <a href="tasks.html">üìã<br>Tasks</a>
    <a href="referral.html">üîó<br>Referral</a>
    <a href="boost.html">‚ö°<br>Boost</a>
  </div>  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import { getDatabase, ref, onValue, get, child, update } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBxQ4EiH_aTCyJm5_VT0cRSDD97F_ObG1o",
      authDomain: "bitdeen-a1ebe.firebaseapp.com",
      databaseURL: "https://bitdeen-a1ebe-default-rtdb.firebaseio.com",
      projectId: "bitdeen-a1ebe",
      storageBucket: "bitdeen-a1ebe.appspot.com",
      messagingSenderId: "957332775205",
      appId: "1:957332775205:web:e34cc38d4d5282adc43acc",
      measurementId: "G-FY8TBYBJ58"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    let uid = localStorage.getItem("bitdeen_uid");
    if (!uid) {
      uid = "user_" + Math.floor(Math.random() * 1000000000);
      localStorage.setItem("bitdeen_uid", uid);
    }

    const checkBtn = document.getElementById("checkBtn");

    // Daily check-in with 24hr timer
    async function setupDailyCheck() {
      const now = Date.now();
      const userRef = ref(db, `users/${uid}`);
      const userSnap = await get(child(ref(db), `users/${uid}`));
      const lastClaim = userSnap.exists() && userSnap.val().dailyCheckTime ? userSnap.val().dailyCheckTime : 0;
      const nextAllowed = lastClaim + 86400000; // 24 hours

      if (now < nextAllowed) {
        checkBtn.disabled = true;
        const interval = setInterval(() => {
          const timeLeft = nextAllowed - Date.now();
          if (timeLeft <= 0) {
            clearInterval(interval);
            checkBtn.disabled = false;
            checkBtn.textContent = "Claim 10 BDN";
          } else {
            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            checkBtn.textContent = `Next claim: ${hours}h ${minutes}m ${seconds}s`;
          }
        }, 1000);
      }
    }

    checkBtn.addEventListener("click", async () => {
      const now = Date.now();
      const userRef = ref(db, `users/${uid}`);
      const userSnap = await get(child(ref(db), `users/${uid}`));
      let current = (userSnap.exists() && userSnap.val().bdn) || 0;

      await update(userRef, {
        bdn: current + 10,
        dailyCheckTime: now
      });

      checkBtn.disabled = true;
      checkBtn.textContent = "Next claim: 24h 0m 0s";
      setupDailyCheck();
      alert("‚úÖ Daily check-in successful! 10 BDN added to your balance.");
    });

    setupDailyCheck();

    // Load Admin Tasks
    const taskList = document.getElementById("taskList");
    function renderTask(taskId, title, desc, link, reward) {
      const div = document.createElement("div");
      div.className = "task-card";
      div.innerHTML = `
        <h3>${title}</h3>
        <p>${desc}</p>
        <button onclick="window.open('${link}', '_blank')">Do Task</button>
        <button onclick="claimReward('${taskId}', ${reward})">Claim ${reward}üíé</button>
      `;
      taskList.appendChild(div);
    }

    onValue(ref(db, "tasks/"), (snapshot) => {
      const existing = document.querySelectorAll(".task-card");
      existing.forEach((e, i) => { if (i !== 0) e.remove(); });
      if (snapshot.exists()) {
        const data = snapshot.val();
        for (const id in data) {
          const task = data[id];
          renderTask(id, task.title, task.desc, task.link, task.reward);
        }
      }
    });

    window.claimReward = async function(taskId, reward) {
      const userTaskRef = ref(db, `users/${uid}/completed/${taskId}`);
      const completedSnap = await get(userTaskRef);
      if (completedSnap.exists()) {
        alert("‚ùå You already claimed this task.");
        return;
      }
      const userRef = ref(db, `users/${uid}`);
      const snapshot = await get(child(ref(db), `users/${uid}`));
      let current = (snapshot.exists() && snapshot.val().diamonds) || 0;
      await update(userRef, {
        diamonds: current + reward,
        [`completed/${taskId}`]: true
      });
      alert(`‚úÖ Task verified and ${reward} Diamonds added!`);
    };
  </script></body>
</html>
